{"mappings":"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","sources":["src/js/components/modal.js"],"sourcesContent":["import { refs } from '../refs/refs';\nimport { getGenresIdsList } from '../api/getGenresIdsList';\nimport { FetchApiMovies } from '../api/fetchMovies';\nimport { renderMoviesList } from '../templates/renderMovies';\nimport { load } from '../library/localStorage';\nimport { addToLibrary } from '../library/localStorage';\nimport { removeFromLibrary } from '../library/localStorage';\nimport { getAllLibraryMovies } from '../library/helper';\nimport { Loader } from './loader';\n\nconst loader = new Loader();\nconst fetchApiMovies = new FetchApiMovies();\n\n//const loader = new Loader();\n//const fetchApiMovies = new FetchApiMovies();\n\nexport function addToggleModal() {\n  const refsModal = {\n    modalOpen: document.querySelectorAll('[data-modal-open]'),\n    modalClose: document.querySelector('[data-modal-close]'),\n    modalBackdrop: document.querySelector('.modal-movie__backdrop')\n  };\n\n  function addModalListener() {\n    refsModal.modalBackdrop.classList.remove(\n      'modal-movie__backdrop--is-hidden'\n    );\n    window.addEventListener('keydown', onEscKeyPress);\n    //loader.on();\n  };\n\n  function removeModalListener() {\n    refsModal.modalBackdrop.classList.add('modal-movie__backdrop--is-hidden');\n  };\n\n  function onBackdropClick(event) {\n    if (event.target != event.currentTarget) {\n      return;\n    };\n    removeModalListener();\n  }\n\n  function onEscKeyPress(event) {\n    if (event.code === 'Escape') {\n      removeModalListener();\n    };\n  };\n\n  refsModal.modalOpen.forEach(modal => {\n    modal.addEventListener('click', addModalListener);\n  });\n\n  refsModal.modalClose.addEventListener('click', removeModalListener);\n\n  refsModal.modalBackdrop.addEventListener('click', onBackdropClick);\n  MovieModalCreate();\n};\n\n\nconst modalMoviePoster = document.querySelector('.modal-movie__poster--img');\nconst modalMovieTitle = document.querySelector('.modal-movie__title');\nconst modalMovieVote = document.querySelector('.modal-movie__vote');\nconst modalMovieVotes = document.querySelector('.modal-movie__votes');\nconst modalMoviePopularity = document.querySelector('.modal-movie__popularity');\nconst modalMovieOriginalTitle = document.querySelector(\n  '.modal-movie__original-title'\n);\nconst modalMovieGenre = document.querySelector('.modal-movie__genre');\nconst modalMovieDescription = document.querySelector('.modal-movie__text');\nconst modalMovieButtonWatched = document.querySelector('.modal-movie__button--watched');\nconst modalMovieButtonQueued = document.querySelector('.modal-movie__button--queue');\n\nfunction MovieModalCreate(){\nconst createModalMovie = document.querySelectorAll('.movie-card__item');\n\ncreateModalMovie.forEach(movie => {\n  movie.addEventListener('click', event => {\n    modalMoviePoster.src = '';\n    modalMovieTitle.innerHTML = '';\n    modalMovieVote.innerHTML = '';\n    modalMovieVotes.innerHTML = '';\n    modalMoviePopularity.innerHTML = '';\n    modalMovieOriginalTitle.innerHTML = '';\n    modalMovieGenre.innerHTML = '';\n    modalMovieDescription.innerHTML = '';\n\n    modalMovieButtonWatched.dataset.id = '';\n    modalMovieButtonQueued.dataset.id = '';\n\n    event.preventDefault();\n\n    const movieId = movie.id;\n    const movieData = fetchApiMovies.getMovieDetails(movieId);\n\n    movieData.then(value => {\n      MovieModalMurkup(value);\n    });\n    loader.off();\n  });\n\n  let onWatched = false;\n  let onQueue = false;\n  \n  load('watchedList')?.forEach(movies => {\n    if (movies.id == movie.id) {\n\n      onWatched = true;\n    }\n  });\n\n\n  load('queueList')?.forEach(movies => {\n    if (movies.id == movie.id) {\n\n      onQueue = true;\n    }\n  });\n\n  let watchedBtn = document.querySelector('.modal-movie__button--watched');\n  let queueBtn = document.querySelector('.modal-movie__button--queue');\n\n\n  if (onWatched) {\n    watchedBtn.innerHTML = 'On List';\n  }\n  if (onQueue) {\n    queueBtn.innerHTML = 'On List';\n  }\n\n  const checkIfOnList = (button, listType, listTypeText) => {\n    let watched;\n    if (listTypeText == undefined) return;\n    if (listTypeText === 'watched') {\n      watched = onWatched;\n    } else if (listTypeText === 'queue') {\n      watched = onQueue;\n    }\n    if (watched) {\n      removeFromLibrary(movie.id, listType);\n      button.innerHTML = `Add to ${listTypeText}`;\n    } else {\n      addToLibrary(movie.id, listType);\n      button.innerHTML = `Added`;\n    }\n    if (listTypeText === 'watched') {\n      onWatched = !onWatched;\n    } else if (listTypeText === 'queue') {\n      onQueue = !onQueue;\n    }\n  };\n\n  watchedBtn.addEventListener('click', () => {\n    checkIfOnList(watchedBtn, 'watchedList', 'watched');\n    if (\n      document.location.href.includes('library') &&\n      refs.moviesList.dataset.listtype === 'watched'\n    ) {\n      let tempLibraryList = load('watchedList');\n      getAllLibraryMovies(tempLibraryList, 'watchedList');\n    }\n  });\n  queueBtn.addEventListener('click', () => {\n    checkIfOnList(queueBtn, 'queueList', 'queue');\n    if (\n      document.location.href.includes('library') &&\n      refs.moviesList.dataset.listtype === 'queue'\n    ) {\n      let tempLibraryList = load('queueList');\n      getAllLibraryMovies(tempLibraryList, 'queueList');\n    }\n  });\n});\n}\n\nfunction MovieModalMurkup({\n  id,\n  poster_path,\n  title,\n  original_title,\n  popularity,\n  overview,\n  genres,\n  vote_average,\n  vote_count\n}) {\n  modalMoviePoster.src = `https://image.tmdb.org/t/p/w500${poster_path}`;\n  modalMovieTitle.innerHTML = title;\n  modalMovieVote.innerHTML = vote_average;\n  modalMovieVotes.innerHTML = vote_count;\n  modalMoviePopularity.innerHTML = popularity;\n  modalMovieOriginalTitle.innerHTML = original_title;\n  modalMovieGenre.innerHTML = genres.map(genre => genre.name)\n  .join(', ');\n  modalMovieDescription.innerHTML = overview;\n  modalMovieButtonWatched.dataset.id = id;\n  modalMovieButtonQueued.dataset.id = id;\n};\n\n\n"],"names":["$cqmI4","parcelRequire","$644ae9dfa4ed5fd0$var$loader","Loader","$644ae9dfa4ed5fd0$var$fetchApiMovies","$lfqeF","FetchApiMovies","$644ae9dfa4ed5fd0$export$58a2b242c2da4af2","refsModal","modalOpen","document","querySelectorAll","modalClose","querySelector","modalBackdrop","addModalListener","classList","remove","window","addEventListener","onEscKeyPress","removeModalListener","add","event","code","forEach","modal","target","currentTarget","movie","ref","ref1","$644ae9dfa4ed5fd0$var$modalMoviePoster","src","$644ae9dfa4ed5fd0$var$modalMovieTitle","innerHTML","$644ae9dfa4ed5fd0$var$modalMovieVote","$644ae9dfa4ed5fd0$var$modalMovieVotes","$644ae9dfa4ed5fd0$var$modalMoviePopularity","$644ae9dfa4ed5fd0$var$modalMovieOriginalTitle","$644ae9dfa4ed5fd0$var$modalMovieGenre","$644ae9dfa4ed5fd0$var$modalMovieDescription","$644ae9dfa4ed5fd0$var$modalMovieButtonWatched","dataset","id","$644ae9dfa4ed5fd0$var$modalMovieButtonQueued","preventDefault","movieId","getMovieDetails","then","value","param","poster_path","title","original_title","popularity","overview","genres","vote_average","vote_count","concat","map","genre","name","join","off","onWatched","onQueue","$6kpMs","load","movies","watchedBtn","queueBtn","checkIfOnList","button","listType","listTypeText","watched","undefined","removeFromLibrary","addToLibrary","location","href","includes","refs","moviesList","listtype","tempLibraryList","$e07ZM","getAllLibraryMovies"],"version":3,"file":"library.4b124575.js.map"}